function sortByTime(n,t){return n.start_time<t.start_time?-1:n.start_time>t.start_time?1:0}function sortByEndTime(n,t){return n.end_time<t.end_time?-1:n.end_time>t.end_time?1:0}function getMinTime(n){for(var t=0;t<n.length;t++)if(n[t].start_time)return parseInt(n[t].start_time,10)}function getMaxTime(n){var t,i;for(n.sort(sortByEndTime),t=n.length-1;t>=0;t--)if(n[t].end_time)return i=n[t].end_time.split(":"),i[1]=="00"?i[0]:parseInt(i[0],10)+1}function calHour(n){var t=n.split(":");return parseInt(t[0],10)+t[1]/60}function getPosition(n,t){return parseInt((calHour(t)-n)*55,10)}function getHeight(n,t){return parseInt((calHour(t)-calHour(n))*55,10)}function checkMulti(n,t){for(var r=1,i=0;i<t.length;i++)n.id!=t[i].id&&(calHour(n.start_time)>=calHour(t[i].start_time)&&calHour(n.start_time)<calHour(t[i].end_time)||calHour(t[i].start_time)>=calHour(n.start_time)&&calHour(t[i].start_time)<calHour(n.end_time))&&r++;return r}function checkOrder(n,t){for(var r=0,i=0;i<t.length;i++)n.id>t[i].id&&(calHour(n.start_time)>=calHour(t[i].start_time)&&calHour(n.start_time)<calHour(t[i].end_time)||calHour(t[i].start_time)>=calHour(n.start_time)&&calHour(t[i].start_time)<calHour(n.end_time))&&r++;return r}function getDayBefore(n,t){var i=new Date;return new Date(i.setTime(n.getTime()-t*864e5))}function getDayAfter(n,t){var i=new Date;return new Date(i.setTime(n.getTime()+t*864e5))}function naviClick(n,t,i,r,u){createTimetable(jQuery("#"+n),t,i,r,u);$("#esports-timetable .timetable-list .timetable-day").length<1?$(".homepage-list-calendar .module-content .no-game").show():$(".homepage-list-calendar .module-content .no-game").hide()}function getTimetables(n,t,i,r){for(var f=[],u=0;u<n.length;u++)n[u].date==t&&n[u].month==i&&n[u].year==r&&f.push(n[u]);return f}function getTimetablesDay(n,t){for(var r=[],i=0;i<n.length;i++)n[i].day==t&&r.push(n[i]);return r}function getTimetablesWeek(n,t,i){for(var u,f=[],r=0;r<n.length;r++)u=new Date(n[r].year,Number(n[r].month)-1,n[r].date),t.getTime()<=u.getTime()&&u.getTime()<=i.getTime()&&f.push(n[r]);return f}function createTimetable(n,t,i,r,u){var f,s,h,c,e,a=new Date,l,o;t=="prevyr"?u--:t=="nextyr"?u++:t=="prevmo"?r--:t=="nextmo"?r++:t=="prevwe"?(e=new Date(i),i=getDayBefore(e,7)):t=="nextwe"&&(e=new Date(i),i=getDayAfter(e,7));r==0?(r=12,u--):r==13&&(r=1,u++);f=new Date(u,r-1,1);l=typeof n.attr("data-start")!="undefined"?n.attr("data-start"):"sunday";s=l=="sunday"?f.getDay()+1:f.getDay()==0?7:f.getDay();h=new Date(u,r,0);c=h.getDate();o=typeof n.attr("data-view")!="undefined"?n.attr("data-view"):"month";o=="week"?timetableWeek(n,tiva_timetables,i):o=="list"?timetableList(n,tiva_timetables,i):timetableMonth(n,tiva_timetables,s,c,r,u);$("#esports-timetable .timetable-list .timetable-day").length<1?$(".homepage-list-calendar .module-content .no-game").show():$(".homepage-list-calendar .module-content .no-game").hide()}function timetableWeek(n,t,i){var h=new Date(i),v=h.getDate(),s=h.getMonth()+1,c=h.getFullYear(),w=getDayAfter(h,6),y=w.getDate(),a=w.getMonth()+1,b=w.getFullYear(),k,p,d,g,nt,ut,tt,it,l,ct=typeof n.attr("data-start")!="undefined"?n.attr("data-start"):"sunday",f="",ft,ot,o,r,u,st,ht,e;ct=="sunday"?(l=[wordDay_sun,wordDay_mon,wordDay_tue,wordDay_wed,wordDay_thu,wordDay_fri,wordDay_sat],k=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]):(l=[wordDay_mon,wordDay_tue,wordDay_wed,wordDay_thu,wordDay_fri,wordDay_sat,wordDay_sun],k=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]);ft=s!=a&&c!=b?wordMonth[s-1].substring(0,3)+" "+v+", "+c+" - "+wordMonth[a-1].substring(0,3)+" "+y+", "+b:s!=a?wordMonth[s-1].substring(0,3)+" "+v+" - "+wordMonth[a-1].substring(0,3)+" "+y+", "+c:wordMonth[s-1].substring(0,3)+" "+v+" - "+y+", "+c;n.attr("data-nav")=="hide"||n.attr("data-mode")=="day"||(f+='<div class="time-navigation"><span class="navi-icon navi-prev" onClick="naviClick(\''+n.attr("id")+"', 'prevwe', '"+h+"', "+s+", "+c+')">&#10094;<\/span><span class="navi-time">'+ft+'<\/span><span class="navi-icon navi-next" onClick="naviClick(\''+n.attr("id")+"', 'nextwe', '"+h+"', "+s+", "+c+')">&#10095;<\/span><\/div>');n.attr("data-mode")=="day"||(t=getTimetablesWeek(t,new Date(c,s-1,v),new Date(b,a-1,y)));var rt=getMinTime(t)?getMinTime(t):8,et=getMaxTime(t)?getMaxTime(t):15,lt=n.attr("data-header-time")=="hide"?"":"show-time";for(f+='<div class="timetable-week '+lt+'">',f+='<div class="timetable-axis">',e=rt;e<=et;e++)ot=e<10?"0"+e:e,f+='<div class="axis-item">'+ot+":00<\/div>";for(f+="<\/div>",f+='<div class="timetable-columns">',o=0;o<l.length;o++){for(p=getDayAfter(h,o),d=p.getDate(),g=p.getMonth()+1,nt=p.getFullYear(),it=n.attr("data-header-time")=="hide"?"":"<br><span>"+wordMonth[g-1].substring(0,3)+" "+d+", "+nt+"<\/span>",ut=o==0?"first-column":"",tt=o==l.length-1?"last-column":"",f+='<div class="timetable-column">',f+=screen.width>768?'<div class="timetable-column-header '+tt+'">'+l[o]+it+"<\/div>":'<div class="timetable-column-header '+tt+'">'+l[o].substring(0,3)+it+"<\/div>",f+='<div class="timetable-column-content">',r=n.attr("data-mode")=="day"?getTimetablesDay(t,k[o]):getTimetables(t,d,g,nt),u=0;u<r.length;u++)if(r[u].start_time&&r[u].end_time){st=r[u].image?'<div class="timetable-image"><img src="'+r[u].image+'" alt="'+r[u].name+'" /><\/div>':"";ht=r[u].end_time?" - "+r[u].end_time:"";var at=getPosition(rt,r[u].start_time),vt=getHeight(r[u].start_time,r[u].end_time),yt=checkMulti(r[u],r)>1?"width:"+100/checkMulti(r[u],r)+"%;":"",pt=checkOrder(r[u],r)>0?"left:"+checkOrder(r[u],r)*(100/checkMulti(r[u],r))+"%":"";f+='<div class="timetable-item"><a class="timetable-title '+r[u].color+'" style="top:'+at+"px; height:"+vt+"px; "+yt+pt+'" href="#'+n.attr("id")+"-popup-"+r[u].id+'" class="open-popup-link"><div class="timetable-title-wrap"><div class="timetable-name">'+r[u].name+'<\/div><div class="timetable-time">'+r[u].start_time+" - "+r[u].end_time+'<\/div><\/div><\/a><div id="'+n.attr("id")+"-popup-"+r[u].id+'" class="timetable-popup zoom-anim-dialog mfp-hide"><div class="popup-header '+r[u].color+'">'+r[u].name+'<\/div><div class="popup-body">'+st+'<div class="timetable-time '+r[u].color+'">'+r[u].start_time+ht+'<\/div><div class="timetable-desc">'+r[u].description+"<\/div><\/div><\/div><\/div>"}for(f+="<\/div>",f+='<div class="timetable-column-grid">',e=rt;e<et;e++)f+='<div class="grid-item '+ut+'"><\/div>';f+="<\/div>";f+="<\/div>"}f+="<\/div>";f+="<\/div>";n.html(f);n.find(".timetable-title").magnificPopup({type:"inline",removalDelay:800,mainClass:"my-mfp-zoom-in"})}function timetableList(n,t,i){var e=new Date(i),w=e.getDate(),o=e.getMonth()+1,s=e.getFullYear(),b=getDayAfter(e,6),k=b.getDate(),c=b.getMonth()+1,nt=b.getFullYear(),d,l,a,v,y,tt,p,ft=typeof n.attr("data-start")!="undefined"?n.attr("data-start"):"sunday",f="",it,r,h,rt,g,u,ut;for(ft=="sunday"?(p=[wordDay_sun,wordDay_mon,wordDay_tue,wordDay_wed,wordDay_thu,wordDay_fri,wordDay_sat],d=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"]):(p=[wordDay_mon,wordDay_tue,wordDay_wed,wordDay_thu,wordDay_fri,wordDay_sat,wordDay_sun],d=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]),it=o!=c&&s!=nt?wordMonth[o-1].substring(0,3)+" "+w+", "+s+" - "+wordMonth[c-1].substring(0,3)+" "+k+", "+nt:o!=c?wordMonth[o-1].substring(0,3)+" "+w+" - "+wordMonth[c-1].substring(0,3)+" "+k+", "+s:wordMonth[o-1].substring(0,3)+" "+w+" - "+k+", "+s,n.attr("data-nav")=="hide"||n.attr("data-mode")=="day"||($(".homepage-list-calendar .module-title .time-navigation").remove(),f+='<div class="time-navigation"><span class="navi-icon navi-prev" onClick="naviClick(\''+n.attr("id")+"', 'prevwe', '"+e+"', "+o+", "+s+')">&#10094;<\/span><span class="navi-time">'+it+'<\/span><span class="navi-icon navi-next" onClick="naviClick(\''+n.attr("id")+"', 'nextwe', '"+e+"', "+o+", "+s+')">&#10095;<\/span><\/div>',$(".homepage-list-calendar .module-title").append(f),f=""),f+='<div class="timetable-list">',h=0;h<p.length;h++)if(l=getDayAfter(e,h),a=l.getDate(),v=l.getMonth()+1,y=l.getFullYear(),rt=new Date(y,v-1,a),g=new Date,g.setHours(0,0,0,0),!(rt<g)&&(r=n.attr("data-mode")=="day"?getTimetablesDay(t,d[h]):getTimetables(t,a,v,y),r.length>0)){for(f+='<div class="timetable-day">',tt=n.attr("data-header-time")=="hide"?"":"<span>"+wordMonth[v-1].substring(0,3)+" "+a+", "+y+"<\/span>",f+='<div class="timetable-header">'+p[h]+tt+"<\/div>",f+='<div class="timetable-content">',u=0;u<r.length;u++)r[u].start_time&&(ut=r[u].image?'<div class="timetable-image"><img src="'+r[u].image+'" alt="'+r[u].name+'" /><\/div>':"",f+='<div class="timetable-item"><span class="timetable-color '+r[u].color+'"><\/span><a class="timetable-title" href="#'+n.attr("id")+"-popup-"+r[u].id+'" class="open-popup-link"><span class="timetable-time">'+r[u].start_time+'<\/span><span class="timetable-name">'+r[u].name+'<\/span><\/a><div id="'+n.attr("id")+"-popup-"+r[u].id+'" class="timetable-popup zoom-anim-dialog mfp-hide"><div class="popup-header '+r[u].color+'">'+r[u].name+'<\/div><div class="popup-body">'+ut+'<div class="timetable-time '+r[u].color+'">'+r[u].start_time+'<\/div><div class="timetable-desc">'+r[u].description+"<\/div><\/div><\/div><\/div>");f+="<\/div>";f+="<\/div>"}f+="<\/div>";n.html(f);n.find(".timetable-title").magnificPopup({type:"inline",removalDelay:800,mainClass:"my-mfp-zoom-in"})}function timetableMonth(n,t,i,r,u,f){var d=tiva_current_date.getDate(),l,g=typeof n.attr("data-start")!="undefined"?n.attr("data-start"):"sunday",s="",h=0,c,a,p,v,w,y,o,e,b,k;for(l=g=="sunday"?[wordDay_sun,wordDay_mon,wordDay_tue,wordDay_wed,wordDay_thu,wordDay_fri,wordDay_sat]:[wordDay_mon,wordDay_tue,wordDay_wed,wordDay_thu,wordDay_fri,wordDay_sat,wordDay_sun],n.attr("data-nav")=="hide"||(s+='<div class="time-navigation"><span class="navi-icon navi-prev" onClick="naviClick(\''+n.attr("id")+"', 'prevmo', '', "+u+", "+f+')">&#10094;<\/span><span class="navi-time">'+wordMonth[u-1]+"&nbsp;&nbsp;"+f+'<\/span><span class="navi-icon navi-next" onClick="naviClick(\''+n.attr("id")+"', 'nextmo', '', "+u+", "+f+')">&#10095;<\/span><\/div>'),s+='<table class="timetable-month">',s+="<tbody>",s+="<tr>",c=0;c<l.length;c++)s+=screen.width>768?'<th class="timetable-header">'+l[c]+"<\/th>":'<th class="timetable-header">'+l[c].substring(0,3)+"<\/th>";for(s+="<\/tr>",a=1,v=1;v<=6;v++)if(w=(v-1)*7+1,w<i+r){for(s+="<tr>",y=1;y<=7;y++){for(h=a-i+1,a++,p=d==h&&tiva_current_month==u&&tiva_current_year==f?"today":"",s+='<td class="calendar-day '+p+'">',h<=r&&h>=1&&(s+='<div class="calendar-daycounter">'+h+"<\/div>"),o=getTimetables(t,h,u,f),e=0;e<o.length;e++)b=o[e].image?'<div class="timetable-image"><img src="'+o[e].image+'" alt="'+o[e].name+'" /><\/div>':"",k=o[e].end_time?" - "+o[e].end_time:"",s+='<div class="timetable-item"><span class="timetable-color '+o[e].color+'"><\/span><a class="timetable-title" href="#'+n.attr("id")+"-popup-"+o[e].id+'" class="open-popup-link"><span class="timetable-time">'+o[e].start_time+'<\/span><span class="timetable-name">'+o[e].name+'<\/span><\/a><div id="'+n.attr("id")+"-popup-"+o[e].id+'" class="timetable-popup zoom-anim-dialog mfp-hide"><div class="popup-header '+o[e].color+'">'+o[e].name+'<\/div><div class="popup-body">'+b+'<div class="timetable-time '+o[e].color+'">'+o[e].start_time+k+'<\/div><div class="timetable-desc">'+o[e].description+"<\/div><\/div><\/div><\/div>";s+="<\/td>"}s+="<\/tr>"}s+="<\/tbody>";s+="<\/table>";n.html(s);n.find(".timetable-title").magnificPopup({type:"inline",removalDelay:800,mainClass:"my-mfp-zoom-in"});a=1}var wordMonth=["OCAK","ŞUBAT","MART","NİSAN","MAYIS","HAZİRAN","TEMMUZ","AĞUSTOS","EYLÜL","EKİM","KASIM","ARALIK"],wordDay_sun="PAZAR",wordDay_mon="PAZARTESİ",wordDay_tue="SALI",wordDay_wed="ÇARŞAMBA",wordDay_thu="PERŞEMBE",wordDay_fri="CUMA",wordDay_sat="CUMARTESİ",tiva_timetables=[],tiva_current_date=new Date,tiva_current_month=tiva_current_date.getMonth()+1,tiva_current_year=tiva_current_date.getFullYear();jQuery(document).ready(function(){jQuery(".tiva-timetable").each(function(n){var r,i,u,t,f;jQuery(this).attr("id","timetable-"+(n+1));r=typeof jQuery(this).attr("data-source")!="undefined"?jQuery(this).attr("data-source"):"json";i=typeof jQuery(this).attr("data-view")!="undefined"?jQuery(this).attr("data-view"):"month";u=jQuery(this).attr("data-mode")=="day"&&(i=="week"||i=="list")?"day":"date";t=jQuery(this);r=="json"?(f=u=="day"?"/esport/calendar":"/esport/calendar",jQuery.getJSON(f,function(n){var u,r,i,e,o,f;for(tiva_timetables=[],u=0;u<n.length;u++)tiva_timetables.push(n[u]);for(tiva_timetables.sort(sortByTime),r=0;r<tiva_timetables.length;r++)tiva_timetables[r].id=r;i=new Date;e=typeof t.attr("data-start")!="undefined"?t.attr("data-start"):"sunday";e=="sunday"?f=new Date(i.setDate(tiva_current_date.getDate()-i.getDay())):(o=i.getDay()==0?7:i.getDay(),f=new Date(i.setDate(tiva_current_date.getDate()-o+1)));createTimetable(t,"current",f,tiva_current_month,tiva_current_year)})):jQuery.ajax({url:"timetable/timetables.php",dataType:"json",data:"",beforeSend:function(){t.html('<div class="loading"><img src="assets/img/loading.gif" /><\/div>')},success:function(n){var u,r,i,e,o,f;for(tiva_timetables=[],u=0;u<n.length;u++)tiva_timetables.push(n[u]);for(tiva_timetables.sort(sortByTime),r=0;r<tiva_timetables.length;r++)tiva_timetables[r].id=r;i=new Date;e=typeof t.attr("data-start")!="undefined"?t.attr("data-start"):"sunday";e=="sunday"?f=new Date(i.setDate(tiva_current_date.getDate()-i.getDay())):(o=i.getDay()==0?7:i.getDay(),f=new Date(i.setDate(tiva_current_date.getDate()-o+1)));createTimetable(t,"current",f,tiva_current_month,tiva_current_year)}})})});